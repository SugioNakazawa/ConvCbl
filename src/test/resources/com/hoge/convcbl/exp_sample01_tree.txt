PROCEDURE DIVISION
00-SAMPLE01 SECTION
PERFORM 10-INIT
10-INIT SECTION
MOVE SPACE TO INI-O1-REC
INITIALIZE INI-O1-REC
MOVE LOW-VALUE TO KEY-NEW
MOVE ZERO TO CTR-AREA
OPEN INPUT IN01-FILE
OPEN OUTPUT OT01-FILE OT02-FILE OT03-FILE
PERFORM 11-READ
11-READ SECTION
READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
*** branch 2 ***
	to b1	MOVE A TO B
	to b1	11-READ-EXIT
	to b1	EXIT
	to b1	10-INIT-EXIT
	to b1	EXIT
	to b1	PERFORM 20-MAIN UNTIL KEY-NEW = HIGH-VALUE
	to b1	20-MAIN SECTION
	to b1	MOVE INI-O1-REC TO W1-REC
	to b1	MOVE I1-AA0001 TO W1-BB0001
	to b1	MOVE I1-AA0002 TO W1-BB0002
	to b1	MOVE I1-AA0003 TO W1-BB0003
	to b1	MOVE I1-AA0004 TO W1-BB0004
	to b1	MOVE I1-AA0005 TO W1-BB0005
	to b1	EVALUATE I1-AA0001 WHEN 1 WHEN 2 MOVE W1-REC TO O2-REC *1,2の時 PERFORM 22-WRITE WHEN 3 MOVE W1-REC TO O3-REC *3の時 PERFORM 23-WRITE WHEN OTHER MOVE W1-REC TO O1-REC *1,2,3以外の時 PERFORM 21-WRITE END-EVALUATE
*** branch 2 ***
	to b1		to b1	MOVE A TO B
	to b1		to b1	PERFORM 11-READ
	to b1		to b1	11-READ SECTION
	to b1		to b1	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
*** branch 2 ***
	to b1		to b1		to b1	MOVE A TO B
	to b1		to b1		to b1	11-READ-EXIT
	to b1		to b1		to b1	EXIT
	to b1		to b1		to b1	20-MAIN-EXIT
	to b1		to b1		to b1	EXIT
	to b1		to b1		to b1	PERFORM 30-END
	to b1		to b1		to b1	30-END SECTION
	to b1		to b1		to b1	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b1		to b1		to b1	MOVE SPACE TO MSG-REC
	to b1		to b1		to b1	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b1		to b1		to b1	MOVE 3 TO MSG-TBL-NUM
	to b1		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b1		to b1		to b1	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b1		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b1		to b1		to b1	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b1		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b1		to b1		to b1	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b1		to b1		to b1	CALL "AAAAMSG" USING MSG-AREA
	to b1		to b1		to b1	30-END-EXIT
	to b1		to b1		to b1	EXIT
	to b1		to b1		to b1	00-SAMPLE01-EXIT
	to b1		to b1		to b1	EXIT PROGRAM
	to b1		to b1		to b2	COMPUTE C TO D
	to b1		to b1		to b2	11-READ-EXIT
	to b1		to b1		to b2	EXIT
	to b1		to b1		to b2	20-MAIN-EXIT
	to b1		to b1		to b2	EXIT
	to b1		to b1		to b2	PERFORM 30-END
	to b1		to b1		to b2	30-END SECTION
	to b1		to b1		to b2	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b1		to b1		to b2	MOVE SPACE TO MSG-REC
	to b1		to b1		to b2	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b1		to b1		to b2	MOVE 3 TO MSG-TBL-NUM
	to b1		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b1		to b1		to b2	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b1		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b1		to b1		to b2	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b1		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b1		to b1		to b2	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b1		to b1		to b2	CALL "AAAAMSG" USING MSG-AREA
	to b1		to b1		to b2	30-END-EXIT
	to b1		to b1		to b2	EXIT
	to b1		to b1		to b2	00-SAMPLE01-EXIT
	to b1		to b1		to b2	EXIT PROGRAM
	to b1		to b2	COMPUTE C TO D
	to b1		to b2	PERFORM 11-READ
	to b1		to b2	11-READ SECTION
	to b1		to b2	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
*** branch 2 ***
	to b1		to b2		to b1	MOVE A TO B
	to b1		to b2		to b1	11-READ-EXIT
	to b1		to b2		to b1	EXIT
	to b1		to b2		to b1	20-MAIN-EXIT
	to b1		to b2		to b1	EXIT
	to b1		to b2		to b1	PERFORM 30-END
	to b1		to b2		to b1	30-END SECTION
	to b1		to b2		to b1	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b1		to b2		to b1	MOVE SPACE TO MSG-REC
	to b1		to b2		to b1	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b1		to b2		to b1	MOVE 3 TO MSG-TBL-NUM
	to b1		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b1		to b2		to b1	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b1		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b1		to b2		to b1	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b1		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b1		to b2		to b1	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b1		to b2		to b1	CALL "AAAAMSG" USING MSG-AREA
	to b1		to b2		to b1	30-END-EXIT
	to b1		to b2		to b1	EXIT
	to b1		to b2		to b1	00-SAMPLE01-EXIT
	to b1		to b2		to b1	EXIT PROGRAM
	to b1		to b2		to b2	COMPUTE C TO D
	to b1		to b2		to b2	11-READ-EXIT
	to b1		to b2		to b2	EXIT
	to b1		to b2		to b2	20-MAIN-EXIT
	to b1		to b2		to b2	EXIT
	to b1		to b2		to b2	PERFORM 30-END
	to b1		to b2		to b2	30-END SECTION
	to b1		to b2		to b2	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b1		to b2		to b2	MOVE SPACE TO MSG-REC
	to b1		to b2		to b2	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b1		to b2		to b2	MOVE 3 TO MSG-TBL-NUM
	to b1		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b1		to b2		to b2	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b1		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b1		to b2		to b2	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b1		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b1		to b2		to b2	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b1		to b2		to b2	CALL "AAAAMSG" USING MSG-AREA
	to b1		to b2		to b2	30-END-EXIT
	to b1		to b2		to b2	EXIT
	to b1		to b2		to b2	00-SAMPLE01-EXIT
	to b1		to b2		to b2	EXIT PROGRAM
	to b2	COMPUTE C TO D
	to b2	11-READ-EXIT
	to b2	EXIT
	to b2	10-INIT-EXIT
	to b2	EXIT
	to b2	PERFORM 20-MAIN UNTIL KEY-NEW = HIGH-VALUE
	to b2	20-MAIN SECTION
	to b2	MOVE INI-O1-REC TO W1-REC
	to b2	MOVE I1-AA0001 TO W1-BB0001
	to b2	MOVE I1-AA0002 TO W1-BB0002
	to b2	MOVE I1-AA0003 TO W1-BB0003
	to b2	MOVE I1-AA0004 TO W1-BB0004
	to b2	MOVE I1-AA0005 TO W1-BB0005
	to b2	EVALUATE I1-AA0001 WHEN 1 WHEN 2 MOVE W1-REC TO O2-REC *1,2の時 PERFORM 22-WRITE WHEN 3 MOVE W1-REC TO O3-REC *3の時 PERFORM 23-WRITE WHEN OTHER MOVE W1-REC TO O1-REC *1,2,3以外の時 PERFORM 21-WRITE END-EVALUATE
*** branch 2 ***
	to b2		to b1	MOVE A TO B
	to b2		to b1	PERFORM 11-READ
	to b2		to b1	11-READ SECTION
	to b2		to b1	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
*** branch 2 ***
	to b2		to b1		to b1	MOVE A TO B
	to b2		to b1		to b1	11-READ-EXIT
	to b2		to b1		to b1	EXIT
	to b2		to b1		to b1	20-MAIN-EXIT
	to b2		to b1		to b1	EXIT
	to b2		to b1		to b1	PERFORM 30-END
	to b2		to b1		to b1	30-END SECTION
	to b2		to b1		to b1	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b2		to b1		to b1	MOVE SPACE TO MSG-REC
	to b2		to b1		to b1	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b2		to b1		to b1	MOVE 3 TO MSG-TBL-NUM
	to b2		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b2		to b1		to b1	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b2		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b2		to b1		to b1	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b2		to b1		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b2		to b1		to b1	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b2		to b1		to b1	CALL "AAAAMSG" USING MSG-AREA
	to b2		to b1		to b1	30-END-EXIT
	to b2		to b1		to b1	EXIT
	to b2		to b1		to b1	00-SAMPLE01-EXIT
	to b2		to b1		to b1	EXIT PROGRAM
	to b2		to b1		to b2	COMPUTE C TO D
	to b2		to b1		to b2	11-READ-EXIT
	to b2		to b1		to b2	EXIT
	to b2		to b1		to b2	20-MAIN-EXIT
	to b2		to b1		to b2	EXIT
	to b2		to b1		to b2	PERFORM 30-END
	to b2		to b1		to b2	30-END SECTION
	to b2		to b1		to b2	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b2		to b1		to b2	MOVE SPACE TO MSG-REC
	to b2		to b1		to b2	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b2		to b1		to b2	MOVE 3 TO MSG-TBL-NUM
	to b2		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b2		to b1		to b2	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b2		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b2		to b1		to b2	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b2		to b1		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b2		to b1		to b2	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b2		to b1		to b2	CALL "AAAAMSG" USING MSG-AREA
	to b2		to b1		to b2	30-END-EXIT
	to b2		to b1		to b2	EXIT
	to b2		to b1		to b2	00-SAMPLE01-EXIT
	to b2		to b1		to b2	EXIT PROGRAM
	to b2		to b2	COMPUTE C TO D
	to b2		to b2	PERFORM 11-READ
	to b2		to b2	11-READ SECTION
	to b2		to b2	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
*** branch 2 ***
	to b2		to b2		to b1	MOVE A TO B
	to b2		to b2		to b1	11-READ-EXIT
	to b2		to b2		to b1	EXIT
	to b2		to b2		to b1	20-MAIN-EXIT
	to b2		to b2		to b1	EXIT
	to b2		to b2		to b1	PERFORM 30-END
	to b2		to b2		to b1	30-END SECTION
	to b2		to b2		to b1	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b2		to b2		to b1	MOVE SPACE TO MSG-REC
	to b2		to b2		to b1	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b2		to b2		to b1	MOVE 3 TO MSG-TBL-NUM
	to b2		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b2		to b2		to b1	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b2		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b2		to b2		to b1	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b2		to b2		to b1	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b2		to b2		to b1	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b2		to b2		to b1	CALL "AAAAMSG" USING MSG-AREA
	to b2		to b2		to b1	30-END-EXIT
	to b2		to b2		to b1	EXIT
	to b2		to b2		to b1	00-SAMPLE01-EXIT
	to b2		to b2		to b1	EXIT PROGRAM
	to b2		to b2		to b2	COMPUTE C TO D
	to b2		to b2		to b2	11-READ-EXIT
	to b2		to b2		to b2	EXIT
	to b2		to b2		to b2	20-MAIN-EXIT
	to b2		to b2		to b2	EXIT
	to b2		to b2		to b2	PERFORM 30-END
	to b2		to b2		to b2	30-END SECTION
	to b2		to b2		to b2	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	to b2		to b2		to b2	MOVE SPACE TO MSG-REC
	to b2		to b2		to b2	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	to b2		to b2		to b2	MOVE 3 TO MSG-TBL-NUM
	to b2		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	to b2		to b2		to b2	MOVE CTR-I1 TO MSG-REC-CTR(1)
	to b2		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	to b2		to b2		to b2	MOVE CTR-O1 TO MSG-REC-CTR(2)
	to b2		to b2		to b2	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	to b2		to b2		to b2	MOVE CTR-O2 TO MSG-REC-CTR(3)
	to b2		to b2		to b2	CALL "AAAAMSG" USING MSG-AREA
	to b2		to b2		to b2	30-END-EXIT
	to b2		to b2		to b2	EXIT
	to b2		to b2		to b2	00-SAMPLE01-EXIT
	to b2		to b2		to b2	EXIT PROGRAM
