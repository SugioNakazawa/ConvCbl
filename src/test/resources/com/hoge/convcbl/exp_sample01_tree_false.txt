PROCEDURE DIVISION
00-SAMPLE01 SECTION
PERFORM 10-INIT
10-INIT SECTION
MOVE SPACE TO INI-O1-REC
INITIALIZE INI-O1-REC
MOVE LOW-VALUE TO KEY-NEW
MOVE ZERO TO CTR-AREA
OPEN INPUT IN01-FILE
OPEN OUTPUT OT01-FILE OT02-FILE OT03-FILE
PERFORM 11-READ
11-READ SECTION
READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
11-READ-EXIT
EXIT
10-INIT-EXIT
EXIT
PERFORM 20-MAIN UNTIL KEY-NEW = HIGH-VALUE
20-MAIN SECTION
MOVE INI-O1-REC TO W1-REC
MOVE I1-AA0001 TO W1-BB0001
MOVE I1-AA0002 TO W1-BB0002
MOVE I1-AA0003 TO W1-BB0003
MOVE I1-AA0004 TO W1-BB0004
MOVE I1-AA0005 TO W1-BB0005
EVALUATE
*** branch 3 ***
	I1-AA0001  = [1, 2]	MOVE W1-REC TO O2-REC *1,2の時
	I1-AA0001  = [1, 2]	PERFORM 22-WRITE
	I1-AA0001  = [1, 2]	22-WRITE SECTION
	I1-AA0001  = [1, 2]	WRITE O2-REC
	I1-AA0001  = [1, 2]	COMPUTE CTR-O2 = CTR-O2 + 1
	I1-AA0001  = [1, 2]	22-WRITE-EXIT
	I1-AA0001  = [1, 2]	EXIT
	I1-AA0001  = [1, 2]	END-EVALUATE
	I1-AA0001  = [1, 2]	PERFORM 11-READ
	I1-AA0001  = [1, 2]	11-READ SECTION
	I1-AA0001  = [1, 2]	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
	I1-AA0001  = [1, 2]	11-READ-EXIT
	I1-AA0001  = [1, 2]	EXIT
	I1-AA0001  = [1, 2]	20-MAIN-EXIT
	I1-AA0001  = [1, 2]	EXIT
	I1-AA0001  = [1, 2]	PERFORM 30-END
	I1-AA0001  = [1, 2]	30-END SECTION
	I1-AA0001  = [1, 2]	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	I1-AA0001  = [1, 2]	MOVE SPACE TO MSG-REC
	I1-AA0001  = [1, 2]	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	I1-AA0001  = [1, 2]	MOVE 3 TO MSG-TBL-NUM
	I1-AA0001  = [1, 2]	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	I1-AA0001  = [1, 2]	MOVE CTR-I1 TO MSG-REC-CTR(1)
	I1-AA0001  = [1, 2]	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	I1-AA0001  = [1, 2]	MOVE CTR-O1 TO MSG-REC-CTR(2)
	I1-AA0001  = [1, 2]	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	I1-AA0001  = [1, 2]	MOVE CTR-O2 TO MSG-REC-CTR(3)
	I1-AA0001  = [1, 2]	CALL "AAAAMSG" USING MSG-AREA
	I1-AA0001  = [1, 2]	30-END-EXIT
	I1-AA0001  = [1, 2]	EXIT
	I1-AA0001  = [1, 2]	00-SAMPLE01-EXIT
	I1-AA0001  = [1, 2]	EXIT PROGRAM
	I1-AA0001  = [3]	MOVE W1-REC TO O3-REC *3の時
	I1-AA0001  = [3]	PERFORM 23-WRITE
	I1-AA0001  = [3]	23-WRITE SECTION
	I1-AA0001  = [3]	WRITE O3-REC
	I1-AA0001  = [3]	COMPUTE CTR-O3 = CTR-O3 + 1
	I1-AA0001  = [3]	23-WRITE-EXIT
	I1-AA0001  = [3]	EXIT
	I1-AA0001  = [3]	END-EVALUATE
	I1-AA0001  = [3]	PERFORM 11-READ
	I1-AA0001  = [3]	11-READ SECTION
	I1-AA0001  = [3]	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
	I1-AA0001  = [3]	11-READ-EXIT
	I1-AA0001  = [3]	EXIT
	I1-AA0001  = [3]	20-MAIN-EXIT
	I1-AA0001  = [3]	EXIT
	I1-AA0001  = [3]	PERFORM 30-END
	I1-AA0001  = [3]	30-END SECTION
	I1-AA0001  = [3]	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	I1-AA0001  = [3]	MOVE SPACE TO MSG-REC
	I1-AA0001  = [3]	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	I1-AA0001  = [3]	MOVE 3 TO MSG-TBL-NUM
	I1-AA0001  = [3]	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	I1-AA0001  = [3]	MOVE CTR-I1 TO MSG-REC-CTR(1)
	I1-AA0001  = [3]	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	I1-AA0001  = [3]	MOVE CTR-O1 TO MSG-REC-CTR(2)
	I1-AA0001  = [3]	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	I1-AA0001  = [3]	MOVE CTR-O2 TO MSG-REC-CTR(3)
	I1-AA0001  = [3]	CALL "AAAAMSG" USING MSG-AREA
	I1-AA0001  = [3]	30-END-EXIT
	I1-AA0001  = [3]	EXIT
	I1-AA0001  = [3]	00-SAMPLE01-EXIT
	I1-AA0001  = [3]	EXIT PROGRAM
	I1-AA0001  = [OTHER]	MOVE W1-REC TO O1-REC *1,2,3以外の時
	I1-AA0001  = [OTHER]	PERFORM 21-WRITE
	I1-AA0001  = [OTHER]	21-WRITE SECTION
	I1-AA0001  = [OTHER]	WRITE O1-REC
	I1-AA0001  = [OTHER]	COMPUTE CTR-O1 = CTR-O1 + 1
	I1-AA0001  = [OTHER]	21-WRITE-EXIT
	I1-AA0001  = [OTHER]	EXIT
	I1-AA0001  = [OTHER]	END-EVALUATE
	I1-AA0001  = [OTHER]	PERFORM 11-READ
	I1-AA0001  = [OTHER]	11-READ SECTION
	I1-AA0001  = [OTHER]	READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-NEW NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 END-READ
	I1-AA0001  = [OTHER]	11-READ-EXIT
	I1-AA0001  = [OTHER]	EXIT
	I1-AA0001  = [OTHER]	20-MAIN-EXIT
	I1-AA0001  = [OTHER]	EXIT
	I1-AA0001  = [OTHER]	PERFORM 30-END
	I1-AA0001  = [OTHER]	30-END SECTION
	I1-AA0001  = [OTHER]	CLOSE IN01-FILE OT01-FILE OT02-FILE OT03-FILE
	I1-AA0001  = [OTHER]	MOVE SPACE TO MSG-REC
	I1-AA0001  = [OTHER]	MOVE CAN-PGMID TO MSG-PROGRAM-ID
	I1-AA0001  = [OTHER]	MOVE 3 TO MSG-TBL-NUM
	I1-AA0001  = [OTHER]	MOVE "XXXXX" TO MSG-MESSAGE-B(1)
	I1-AA0001  = [OTHER]	MOVE CTR-I1 TO MSG-REC-CTR(1)
	I1-AA0001  = [OTHER]	MOVE "XXXXX" TO MSG-MESSAGE-B(2)
	I1-AA0001  = [OTHER]	MOVE CTR-O1 TO MSG-REC-CTR(2)
	I1-AA0001  = [OTHER]	MOVE "XXXXX" TO MSG-MESSAGE-B(3)
	I1-AA0001  = [OTHER]	MOVE CTR-O2 TO MSG-REC-CTR(3)
	I1-AA0001  = [OTHER]	CALL "AAAAMSG" USING MSG-AREA
	I1-AA0001  = [OTHER]	30-END-EXIT
	I1-AA0001  = [OTHER]	EXIT
	I1-AA0001  = [OTHER]	00-SAMPLE01-EXIT
	I1-AA0001  = [OTHER]	EXIT PROGRAM
