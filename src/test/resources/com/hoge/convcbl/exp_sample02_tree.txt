PROCEDURE DIVISION
00-SAMPLE02 SECTION
PERFORM 10-INIT
10-INIT SECTION
MOVE SPACE TO INI-O1-REC
INITIALIZE INI-O1-REC
MOVE LOW-VALUE TO KEY-AREA
MOVE ZERO TO CTR-AREA
OPEN INPUT IN01-FILE IN02-FILE
OPEN OUTPUT OT01-FILE
PERFORM 11-READ
11-READ SECTION
READ IN01-FILE AT END MOVE HIGH-VALUE TO KEY-I1 NOT AT END COMPUTE CTR-I1 = CTR-I1 + 1 MOVE I1-XX0001 TO KEY-I1-XX0001 MOVE I1-YY0001 TO KEY-I1-YY0001 END-READ
*** branch 2 ***
	to b1	MOVE A TO B
	to b1	11-READ-EXIT
	to b1	EXIT
	to b1	PERFORM 12-READ
	to b1	12-READ SECTION
	to b1	READ IN02-FILE AT END MOVE HIGH-VALUE TO KEY-I2 NOT AT END COMPUTE CTR-I2 = CTR-I2 + 1 MOVE I2-XX0001 TO KEY-I2-XX0001 MOVE I2-YY0001 TO KEY-I2-YY0001 END-READ
*** branch 2 ***
	to b1		to b1	MOVE A TO B
	to b1		to b1	12-READ-EXIT
	to b1		to b1	EXIT
	to b1		to b1	10-INIT-EXIT
	to b1		to b1	EXIT
	to b1		to b1	PERFORM 20-MAIN UNTIL ( KEY-I1 = HIGH-VALUE ) AND ( KEY-I2 = HIGH-VALUE )
	to b1		to b1	20-MAIN SECTION
	to b1		to b1	EVALUATE TRUE WHEN KEY-I1 < KEY-I2 PERFORM 21-I1-ONLY PERFORM 11-READ WHEN KEY-I1 > KEY-I2 PERFORM 22-I2-ONLY PERFORM 12-READ WHEN KEY-I1 = KEY-I2 PERFORM UNTIL KEY-I1 NOT = KEY-I2 PERFORM 23-MATCH PERFORM 12-READ END-PERFORM PERFORM 11-READ END-EVALUATE 20-MAIN-EXIT
*** branch 2 ***
	to b1		to b1		to b1	MOVE A TO B
	to b1		to b1		to b1	EXIT
	to b1		to b1		to b1	PERFORM 30-END
	to b1		to b1		to b1	30-END SECTION
	to b1		to b1		to b1	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b1		to b1		to b1	30-END-EXIT
	to b1		to b1		to b1	EXIT
	to b1		to b1		to b1	00-SAMPLE02-EXIT
	to b1		to b1		to b1	EXIT PROGRAM
	to b1		to b1		to b2	COMPUTE C TO D
	to b1		to b1		to b2	EXIT
	to b1		to b1		to b2	PERFORM 30-END
	to b1		to b1		to b2	30-END SECTION
	to b1		to b1		to b2	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b1		to b1		to b2	30-END-EXIT
	to b1		to b1		to b2	EXIT
	to b1		to b1		to b2	00-SAMPLE02-EXIT
	to b1		to b1		to b2	EXIT PROGRAM
	to b1		to b2	COMPUTE C TO D
	to b1		to b2	12-READ-EXIT
	to b1		to b2	EXIT
	to b1		to b2	10-INIT-EXIT
	to b1		to b2	EXIT
	to b1		to b2	PERFORM 20-MAIN UNTIL ( KEY-I1 = HIGH-VALUE ) AND ( KEY-I2 = HIGH-VALUE )
	to b1		to b2	20-MAIN SECTION
	to b1		to b2	EVALUATE TRUE WHEN KEY-I1 < KEY-I2 PERFORM 21-I1-ONLY PERFORM 11-READ WHEN KEY-I1 > KEY-I2 PERFORM 22-I2-ONLY PERFORM 12-READ WHEN KEY-I1 = KEY-I2 PERFORM UNTIL KEY-I1 NOT = KEY-I2 PERFORM 23-MATCH PERFORM 12-READ END-PERFORM PERFORM 11-READ END-EVALUATE 20-MAIN-EXIT
*** branch 2 ***
	to b1		to b2		to b1	MOVE A TO B
	to b1		to b2		to b1	EXIT
	to b1		to b2		to b1	PERFORM 30-END
	to b1		to b2		to b1	30-END SECTION
	to b1		to b2		to b1	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b1		to b2		to b1	30-END-EXIT
	to b1		to b2		to b1	EXIT
	to b1		to b2		to b1	00-SAMPLE02-EXIT
	to b1		to b2		to b1	EXIT PROGRAM
	to b1		to b2		to b2	COMPUTE C TO D
	to b1		to b2		to b2	EXIT
	to b1		to b2		to b2	PERFORM 30-END
	to b1		to b2		to b2	30-END SECTION
	to b1		to b2		to b2	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b1		to b2		to b2	30-END-EXIT
	to b1		to b2		to b2	EXIT
	to b1		to b2		to b2	00-SAMPLE02-EXIT
	to b1		to b2		to b2	EXIT PROGRAM
	to b2	COMPUTE C TO D
	to b2	11-READ-EXIT
	to b2	EXIT
	to b2	PERFORM 12-READ
	to b2	12-READ SECTION
	to b2	READ IN02-FILE AT END MOVE HIGH-VALUE TO KEY-I2 NOT AT END COMPUTE CTR-I2 = CTR-I2 + 1 MOVE I2-XX0001 TO KEY-I2-XX0001 MOVE I2-YY0001 TO KEY-I2-YY0001 END-READ
*** branch 2 ***
	to b2		to b1	MOVE A TO B
	to b2		to b1	12-READ-EXIT
	to b2		to b1	EXIT
	to b2		to b1	10-INIT-EXIT
	to b2		to b1	EXIT
	to b2		to b1	PERFORM 20-MAIN UNTIL ( KEY-I1 = HIGH-VALUE ) AND ( KEY-I2 = HIGH-VALUE )
	to b2		to b1	20-MAIN SECTION
	to b2		to b1	EVALUATE TRUE WHEN KEY-I1 < KEY-I2 PERFORM 21-I1-ONLY PERFORM 11-READ WHEN KEY-I1 > KEY-I2 PERFORM 22-I2-ONLY PERFORM 12-READ WHEN KEY-I1 = KEY-I2 PERFORM UNTIL KEY-I1 NOT = KEY-I2 PERFORM 23-MATCH PERFORM 12-READ END-PERFORM PERFORM 11-READ END-EVALUATE 20-MAIN-EXIT
*** branch 2 ***
	to b2		to b1		to b1	MOVE A TO B
	to b2		to b1		to b1	EXIT
	to b2		to b1		to b1	PERFORM 30-END
	to b2		to b1		to b1	30-END SECTION
	to b2		to b1		to b1	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b2		to b1		to b1	30-END-EXIT
	to b2		to b1		to b1	EXIT
	to b2		to b1		to b1	00-SAMPLE02-EXIT
	to b2		to b1		to b1	EXIT PROGRAM
	to b2		to b1		to b2	COMPUTE C TO D
	to b2		to b1		to b2	EXIT
	to b2		to b1		to b2	PERFORM 30-END
	to b2		to b1		to b2	30-END SECTION
	to b2		to b1		to b2	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b2		to b1		to b2	30-END-EXIT
	to b2		to b1		to b2	EXIT
	to b2		to b1		to b2	00-SAMPLE02-EXIT
	to b2		to b1		to b2	EXIT PROGRAM
	to b2		to b2	COMPUTE C TO D
	to b2		to b2	12-READ-EXIT
	to b2		to b2	EXIT
	to b2		to b2	10-INIT-EXIT
	to b2		to b2	EXIT
	to b2		to b2	PERFORM 20-MAIN UNTIL ( KEY-I1 = HIGH-VALUE ) AND ( KEY-I2 = HIGH-VALUE )
	to b2		to b2	20-MAIN SECTION
	to b2		to b2	EVALUATE TRUE WHEN KEY-I1 < KEY-I2 PERFORM 21-I1-ONLY PERFORM 11-READ WHEN KEY-I1 > KEY-I2 PERFORM 22-I2-ONLY PERFORM 12-READ WHEN KEY-I1 = KEY-I2 PERFORM UNTIL KEY-I1 NOT = KEY-I2 PERFORM 23-MATCH PERFORM 12-READ END-PERFORM PERFORM 11-READ END-EVALUATE 20-MAIN-EXIT
*** branch 2 ***
	to b2		to b2		to b1	MOVE A TO B
	to b2		to b2		to b1	EXIT
	to b2		to b2		to b1	PERFORM 30-END
	to b2		to b2		to b1	30-END SECTION
	to b2		to b2		to b1	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b2		to b2		to b1	30-END-EXIT
	to b2		to b2		to b1	EXIT
	to b2		to b2		to b1	00-SAMPLE02-EXIT
	to b2		to b2		to b1	EXIT PROGRAM
	to b2		to b2		to b2	COMPUTE C TO D
	to b2		to b2		to b2	EXIT
	to b2		to b2		to b2	PERFORM 30-END
	to b2		to b2		to b2	30-END SECTION
	to b2		to b2		to b2	CLOSE IN01-FILE IN02-FILE OT01-FILE
	to b2		to b2		to b2	30-END-EXIT
	to b2		to b2		to b2	EXIT
	to b2		to b2		to b2	00-SAMPLE02-EXIT
	to b2		to b2		to b2	EXIT PROGRAM
